Version 4
SHEET 1 2932 2036
WIRE 1472 -224 1376 -224
WIRE 1472 -144 1472 -224
WIRE 1376 -112 1376 -224
WIRE 1472 -32 1472 -64
WIRE -224 48 -224 -48
WIRE 976 48 704 48
WIRE 1136 48 1072 48
WIRE 1312 48 1232 48
WIRE 1376 48 1376 -112
WIRE 1376 48 1312 48
WIRE 1888 96 1728 96
WIRE 2160 96 1888 96
WIRE 2320 96 2256 96
WIRE 2704 96 2416 96
WIRE 2864 96 2704 96
WIRE 2864 144 2864 96
WIRE 2032 176 1968 176
WIRE 2176 176 2176 144
WIRE 2176 176 2032 176
WIRE -896 192 -896 112
WIRE -224 208 -224 128
WIRE 992 208 992 96
WIRE 2400 224 2400 144
WIRE 2512 224 2400 224
WIRE 2576 224 2512 224
WIRE 2704 224 2704 96
WIRE 2704 224 2672 224
WIRE 2176 256 2176 176
WIRE 2400 256 2400 224
WIRE 2864 288 2864 224
WIRE 1312 304 1312 48
WIRE 1344 304 1312 304
WIRE 1664 304 1440 304
WIRE 2512 304 2512 224
WIRE 2592 304 2592 272
WIRE 2592 304 2512 304
WIRE 2672 304 2592 304
WIRE 992 320 992 288
WIRE 1424 352 1344 352
WIRE 2176 368 2176 336
WIRE 2400 368 2400 336
WIRE -224 416 -224 384
WIRE 1216 480 1216 96
WIRE 1424 480 1424 352
WIRE 1424 480 1216 480
WIRE 1664 480 1664 304
WIRE 1664 480 1424 480
WIRE 1792 480 1664 480
WIRE 2512 480 2512 304
WIRE 2512 480 1792 480
WIRE -224 528 -224 496
WIRE 1216 528 1216 480
WIRE 1216 640 1216 608
FLAG -224 208 0
FLAG -224 528 0
FLAG 992 320 0
FLAG 1216 640 0
FLAG 1376 -112 BATT_in
FLAG 2176 368 0
FLAG 2400 368 0
FLAG 1888 96 BATT_out
FLAG 2864 288 0
FLAG -224 -48 VCC_solar
FLAG 704 48 VCC_solar
FLAG -224 384 Vcc_USB
FLAG 1792 480 Vcc_USB
FLAG 2032 176 BMS_signal
FLAG -896 112 BMS_signal
FLAG -896 272 0
FLAG 1472 -32 0
SYMBOL voltage -224 32 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Solar
SYMATTR Value PWL(0 6 0.1 15 0.3 15 0.45 0)
SYMBOL voltage -224 400 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 124 Left 2
SYMATTR SpiceLine Rser=0.01
SYMATTR InstName VBus
SYMATTR Value 0
SYMBOL pmos 1136 96 R270
SYMATTR InstName M5
SYMBOL pmos 1072 96 M270
SYMATTR InstName M6
SYMBOL res 976 192 R0
SYMATTR InstName R7
SYMATTR Value 1k
SYMBOL res 1200 512 R0
SYMATTR InstName R8
SYMATTR Value 100k
SYMBOL pmos 2320 144 R270
SYMATTR InstName M7
SYMBOL pmos 2256 144 M270
SYMATTR InstName M8
SYMBOL res 2160 240 R0
SYMATTR InstName R10
SYMATTR Value 100k
SYMBOL res 2384 240 R0
SYMATTR InstName R11
SYMATTR Value 100k
SYMBOL res 2848 128 R0
SYMATTR InstName R12
SYMATTR Value 10
SYMBOL nmos 1344 352 R270
SYMATTR InstName M9
SYMBOL nmos 2672 272 M270
SYMATTR InstName M10
SYMBOL bv -896 176 R0
SYMATTR InstName B1
SYMATTR Value V = if(V(BATT_OUT)< 3,V(BATT_OUT),0)
SYMBOL bi 1472 -144 R0
SYMATTR InstName B2
SYMATTR Value I=2
TEXT -936 496 Left 2 !.tran 0.5 startup
TEXT -936 536 Left 2 !.model sw sw vt=1
TEXT -936 568 Left 2 !.model testn nmos(kp=90u vt0=1 lambda=0.01)
TEXT -936 600 Left 2 !.model testn pmos(kp=90u vt0=1 lambda=0.01)
